<nav id="main-menu" role="navigation">
	<div id="main-menu-inner">
		<div ng-show="listTracker.active()" id="menu-content-demo" class="menu-content top">
			<div>
				<div class="loading" ng-show="listTracker.active()" us-spinner="{color:'#7f8796'}"></div>
			</div>
		</div>
		<section class="tournament" ng-repeat="tournament in tournaments">
			<header>
				<div class="img-bg">
					<div
						ng-repeat="machine in tournament.machines" 
      					ng-if="machine.image.length > 0"
      				>
      					<img ng-src="img/machines/{{machine.image}}" />
      				</div>
      			</div>
      			<h1><a href="" ng-click="jumpToMachine({tournament_id: tournament.id}, 0)" class="tournament-title"><span>{{tournament.title}}</span></a></h1>
			</header>
			<ul class="navigation" ng-hide="listTracker.active()">
				<li 
					ng-repeat="machine in tournament.machines" 
					ng-class="{active: current_tournament.id == tournament.id && $index == current_index}"
				>
					<a href="" ng-click="jumpToMachine(machine, $index)">{{machine.title}}</a>
				</li>
				<li ng-if="tournament.machines.length > 1" ng-class="{current: current_tournament.id == tournament.id && current_index == tournament.machines.length}">
					<a href="" ng-click="jumpToMachine({id: 'total', title:'Totals', tournament_id: tournament.id}, tournament.machines.length)">Totals</a>
				</li>
				<li ng-if="tournament.machines.length == 0" class="repeat-empty text-muted">No machines add to the tournament yet</li>
			</ul>
		</section>
	</div> <!-- / #main-menu-inner -->
</nav> <!-- / #main-menu -->

<div id="content-wrapper">


	<div id="tournament" >

		<!--<div class="loading" ng-show="tournamentTracker.active()" us-spinner="{color:'#555'}"></div>-->
		<div class="loading-bride" ng-show="tournamentTracker.active()">
			<img src="img/loading-bride.gif" />
			<p>loading&hellip;</p>
		</div>


		<article ng-if="current_tournament && !tournamentTracker.active()">

			<header class="page-header">			
				<div class="row">
					<!-- Page header, center on small screens -->
					<h1 class="col-xs-12 text-center text-left-sm"><strong>{{current_tournament.title}}</strong> {{current_index != current_tournament.machines.length ? current_tournament.machines[current_index].title : 'Totals'}}</h1>
				</div>
			</header>

			<slick 
				class="machines"
				infinite="false"
				slides-to-show="4" 
				slides-to-scroll="4"
				current-index = "current_index"
				responsive = "breakpoints"
			>


				<div ng-repeat="machine in current_tournament.machines" class="machine panel panel-default" data-machine-id="{{machine.id}}">
					<header>
						<div class="bg-cover" ng-show="machine.image.length">
							<img ng-src="img/machines/{{machine.image}}" />
						</div>
						<span class="abbv">{{machine.abbv}}</span>
						<h2>{{machine.title}}</h2>
					</header>
					<table class="machine-data table" ng-if="machine.scores.length > 0">
						<thead>
							<tr>
								<th class="pts">
									<span ng-if="current_tournament.machines.length == 1">Rank</span>
									<span ng-if="current_tournament.machines.length > 1">Pts.</span>
								</th>
								<th class="player">Player</th>
								<th class="score">Score</th>
							</tr>
						</thead>
						<tbody ng-repeat="score in machine.scores | orderBy:'score':true track by score.player_id">
							<tr ng-if="current_tournament.machines.length == 1 && $index == current_tournament.cutoff">
								<td class="cutoff" colspan="3">Qualified Cutoff</td>
							</tr>
							<tr class="repeat-animation hide-fade">
								<td class="pts">
									<span ng-if="current_tournament.machines.length == 1">{{$index+1}}</span>
									<span ng-if="current_tournament.machines.length > 1">{{points[$index]}}</span>
								</td>
								<td class="player">{{score.player.first_name}} {{score.player.last_name}}</td>
								<td class="score">{{score.score | number:0}}</td>
							</tr>
						</tbody>
					</table>
					<div ng-if="machine.scores.length == 0" class="repeat-empty text-muted">
						Quick! Get a game in, you're guaranteed 100 points right now!
					</div>
				</div>

				<div ng-if="current_tournament.machines.length > 1" class="machine totals panel panel-default" data-machine-id="totals">
					<header>
						<div class="bg-cover">
							<img src="img/damage2.jpg" />
						</div>
						<span class="abbv">=</span>
						<h2>Totals</h2>
					</header>
					<table class="machine-data totals-data table">
						<thead>
							<tr>
								<th class="rank">Rank</th>
								<th class="player">Player</th>
								<th class="score">Points</th>
							</tr>
						</thead>
						<tbody ng-repeat="score in current_tournament.totals | orderObjectBy:'points':true track by score.player_id">
							<tr ng-if="$index == current_tournament.cutoff">
								<td class="cutoff" colspan="3">Qualified Cutoff</td>
							</tr>
							<tr class="repeat-animation hide-fade">
								<td class="pts">{{$index+1}}</td>
								<td class="player">{{score.first_name}} {{score.last_name}}</td>
								<td class="score">{{score.points | number:0}}</td>
							</tr>
						</tbody>
					</table>
					<div class="repeat-empty text-muted" ng-if="current_tournament.totals.length == 0">
						No scores entered yet
					</div>
				</div>


			</slick>

		</article>
	</div>

</div>